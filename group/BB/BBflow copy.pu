@startuml BBショップ業務フロー水平

start

fork
    partition 顧客（販売システム） {
        :商品を閲覧・選択;
        :カートに追加;
        :注文情報入力 (配送先・数量など);
        :支払いを実行;

        if (決済成功?) then (yes)
          :注文情報をシステムに登録;
          :注文確認メール送信;
          ->管理者（管理システム）: 注文通知
        else (no)
          :エラーメッセージ表示;
          stop
        endif

        :注文状況を確認;
        if (返品申請 10日以内?) then (yes)
          :返品申請;
          ->管理者（管理システム）: 返品通知
        else (no)
          :処理終了;
        endif
    }
fork again
    partition 管理者（管理システム） {
        :注文情報を確認;
        :在庫確認;
        :梱包作業を行う;
        :発送処理 (伝票番号登録);
        :ステータス更新「発送済み」;
        :発送完了メール送信;

        if (返品申請がある?) then (yes)
          :返品受付;
          :返品商品を確認;
          :返金処理;
          :ステータス更新「返品完了」;
        else (no)
          :処理終了;
        endif
    }
end fork

stop
@enduml
